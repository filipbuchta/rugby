(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{14:function(t,e,i){},16:function(t,e,i){"use strict";i.r(e);var s=i(2),a=i.n(s),l=i(4),r=i.n(l),n=(i(14),i(0)),h=i(1),o=i(6),y=i(5),c=i(7),u=function(){function t(e){Object(n.a)(this,t),this.spriteSheet=e,this.direction=!1}return Object(h.a)(t,[{key:"update",value:function(t){null!=this.currentAnimation&&(this.timer+=t,this.timer>50&&(this.timer=0,this.frame++,this.frame>=this.currentAnimation.firstFrame+this.currentAnimation.frameCount&&(this.currentAnimation.loop?this.frame=this.currentAnimation.firstFrame:this.frame=this.currentAnimation.firstFrame+this.currentAnimation.frameCount-1)))}},{key:"draw",value:function(t){this.currentAnimation;var e=(this.frame%(this.spriteSheet.image.width/this.spriteSheet.frameSize.width)|0)*this.spriteSheet.frameSize.width,i=(this.frame/(this.spriteSheet.image.width/this.spriteSheet.frameSize.width)|0)*this.spriteSheet.frameSize.height;this.direction&&(t.save(),t.scale(-1,1)),t.drawImage(this.spriteSheet.image,e,i,this.spriteSheet.frameSize.width,this.spriteSheet.frameSize.height,-this.spriteSheet.frameSize.width/2,-this.spriteSheet.frameSize.height,this.spriteSheet.frameSize.width,this.spriteSheet.frameSize.height),this.direction&&t.restore()}},{key:"playAnimation",value:function(t){this.currentAnimation!=this.spriteSheet.animations[t]&&(this.timer=0,this.currentAnimation=this.spriteSheet.animations[t],this.frame=this.currentAnimation.firstFrame)}}]),t}(),m=function t(){Object(n.a)(this,t)},d=function(){function t(){Object(n.a)(this,t)}return Object(h.a)(t,[{key:"throw",value:function(t,e,i,s){var a=t-this.x,l=e-this.y,r=Math.sqrt(a*a+l*l);this.velocityX=a/r*s,this.velocityY=l/r*s,this.velocityZ=i*s,this.rotationSpeed=.02,this.lastPlayer=this.player,this.player=null,this.sound.currentTime=0,this.sound.play()}},{key:"update",value:function(e,i,s){null!=this.player?(this.x=this.player.x+(this.player.direction?5:-5),this.z=t.HOLDING_HEIGHT,this.y=this.player.y,this.velocityX=this.player.velocityX,this.velocityY=this.player.velocityY,this.angle=Math.PI/4*(this.player.direction?-1:1)):(this.velocityZ-=.0025*e,this.x+=this.velocityX*e,this.y+=this.velocityY*e,this.z+=this.velocityZ*e,this.x<t.ballWidth&&(this.x=t.ballWidth),this.y<t.ballHeight&&(this.y=t.ballHeight),this.x>i-t.ballWidth&&(this.x=i-t.ballWidth),this.y>s-t.ballHeight&&(this.y=s-t.ballHeight),this.z<0&&(this.z=0,this.velocityX*=t.ballDampening,this.velocityY*=t.ballDampening,this.velocityZ*=t.ballDampening,this.rotationSpeed*=t.ballDampening,this.velocityZ*=-1),this.angle+=this.rotationSpeed*e)}}]),t}();function p(t){var e=function(t){return Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2))}(t);return{x:t.x/e,y:t.y/e}}function v(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function f(t,e,i){return v(t,e)<i}d.ballWidth=13,d.ballHeight=9,d.ballDampening=.6,d.HOLDING_HEIGHT=10;var b=function(){function t(){Object(n.a)(this,t),this.velocityX=0,this.velocityY=0,this.movementX=0,this.movementY=0,this.speed=1/750,this.maxSpeed=.14,this.gotoTarget=null}return Object(h.a)(t,[{key:"goto",value:function(t){this.gotoTarget=t}},{key:"update",value:function(t,e,i){null!=this.gotoTarget&&(this.movementX=this.x>this.gotoTarget.x?-1:1,this.movementY=this.y>this.gotoTarget.y?-1:1,f(this,this.gotoTarget,8)&&(this.movementX=0,this.movementY=0,this.gotoTarget=null));var s=this.speed*t;0===this.movementX?this.velocityX*=.6:(this.velocityX+=this.movementX>0?s:-s,this.velocityX=Math.min(this.maxSpeed,Math.max(-this.maxSpeed,this.velocityX))),0===this.movementY?this.velocityY*=.6:(this.velocityY+=this.movementY>0?s:-s,this.velocityY=Math.min(this.maxSpeed,Math.max(-this.maxSpeed,this.velocityY))),this.velocityX<.001&&this.velocityX>-.001&&(this.velocityX=0),this.velocityY<.001&&this.velocityY>-.001&&(this.velocityY=0),this.x+=this.velocityX*t,this.y+=this.velocityY*t,this.x<0&&(this.x=0),this.y<0&&(this.y=0),this.x>e&&(this.x=e),this.y>i&&(this.y=i),this.velocityX>0?this.direction=!0:this.velocityX<0&&(this.direction=!1),this.velocityY>0||this.velocityY<0||this.velocityX>0||this.velocityX<0?this.sprite.playAnimation("run"):this.sprite.playAnimation("idle"),this.sprite.direction=this.direction,this.sprite.update(t),null!=this.quote&&(this.quoteTime-=t,this.quoteTime<0&&(this.quote=null))}},{key:"setQuote",value:function(t){this.quote=t,this.quoteTime=5e3}},{key:"draw",value:function(t){this.sprite.draw(t),null!=this.quote&&(t.translate(-5-this.quote.length,-32),t.font="6px 'Press Start 2P'",t.strokeStyle="black",t.lineWidth=3,t.strokeText(this.quote,0,0),t.fillStyle="white",t.fillText(this.quote,0,0))}}]),t}();b.TACKLE_DISTANCE=20;var g=function(){function t(e){var i=this;Object(n.a)(this,t),t.keys=[],t.lastKeys=[],this.selectedTeam=2*Math.random()|0,this.gameState="GAME",this.canvas=e,window.addEventListener("keydown",function(e){t.keys[e.keyCode]||(t.keys[e.keyCode]=!0)},!0),window.addEventListener("keyup",function(e){t.keys[e.keyCode]&&(t.keys[e.keyCode]=!1)},!0),this.context=this.canvas.getContext("2d"),this.assets={},this.assets["song.mp3"]=new Audio("assets/song.mp3"),this.assets["song.mp3"].volume=.75,this.assets["blob.mp3"]=new Audio("assets/blob.mp3"),this.assets["win.mp3"]=new Audio("assets/win.mp3"),Promise.all([this.loadImage("lawyer.png"),this.loadImage("ball.png"),this.loadImage("doctor.png"),this.loadImage("field.png"),this.loadJson("playerSprite.json")]).then(function(){return i.onAssetsLoaded()})}return Object(h.a)(t,[{key:"loadImage",value:function(t){var e=this;return new Promise(function(i,s){var a=new Image;a.onerror=function(e){console.error("Unable to load image",t,e),s(e.error)},a.onload=function(s){e.assets[t]=a,i(a)},a.src="assets/"+t,a.complete&&(e.assets[t]=a,i(a))})}},{key:"loadJson",value:function(t){var e=this;return new Promise(function(i,s){var a=new XMLHttpRequest;a.open("GET","assets/"+t,!0),a.onerror=function(t){s(new Error("JSON request failed: "+t.message))},a.onreadystatechange=function(l){if(4==a.readyState)if(200==a.status){var r;try{r=JSON.parse(a.responseText)}catch(n){throw n instanceof SyntaxError&&s(new Error("Invalid JSON content",n)),n}e.assets[t]=r,i(r)}else 404==a.status&&s(new Error("JSON Asset not found"))},a.send()})}}]),Object(h.a)(t,[{key:"onAssetsLoaded",value:function(){this.playSound("song.mp3"),this.assets["doctorSprite.json"]=JSON.parse(JSON.stringify(this.assets["playerSprite.json"])),this.assets["playerSprite.json"].image=this.assets["lawyer.png"],this.assets["doctorSprite.json"].image=this.assets["doctor.png"],this.score=[0,0],this.startLevel(),this.delta=0,this.tick=this.tick.bind(this),requestAnimationFrame(this.tick)}},{key:"startLevel",value:function(){this.gameEnd=!1,this.players=[];for(var e=0;e<2;e++)for(var i=0;i<3;i++){var s=new b;s.index=this.players.length,s.sprite=new u(this.assets[0===e?"playerSprite.json":"doctorSprite.json"]),s.team=e,s.x=130+250*e+i%2*(0===e?-1:1)*30,s.y=60+40*(i+1),s.direction=0===e,s.role=1===i?"defender":"attacker",this.players.push(s)}if(this.ball=new d,this.ball.sound=this.assets["blob.mp3"],this.ball.x=this.assets["field.png"].width/2,this.ball.y=this.assets["field.png"].height/2,this.ball.z=0,this.ball.velocityX=0,this.ball.velocityY=0,this.ball.velocityZ=0,this.ball.rotationSpeed=0,this.ball.angle=0,this.selectedPlayer=this.players[this.selectedTeam*(this.players.length/2)+Math.random()*this.players.length/2|0],this.selectedPlayer.maxSpeed*=1.2,t.camera=new m,this.timer=0,this.score[0]>2||this.score[1]>2){var a=!0,l=!1,r=void 0;try{for(var n,h=this.players[Symbol.iterator]();!(a=(n=h.next()).done);a=!0){var o=n.value;o.team=this.selectedPlayer.team,o.role="ending"}}catch(y){l=!0,r=y}finally{try{a||null==h.return||h.return()}finally{if(l)throw r}}this.selectedPlayer=null}t.keys=[]}},{key:"tick",value:function(t){requestAnimationFrame(this.tick),null==this.lastTick&&(this.lastTick=t);for(this.delta+=t-this.lastTick,this.lastTick=t;this.delta>=1e3/60;)this.update(1e3/60),this.delta-=1e3/60;this.draw()}},{key:"update",value:function(e){var i=this;e*=.5;var s=this.assets["field.png"].width,a=this.assets["field.png"].height;null!=this.selectedPlayer&&(t.keys[32]&&this.ball.player===this.selectedPlayer&&(this.selectedPlayer.direction&&0===this.selectedPlayer.team||!this.selectedPlayer.direction&&1===this.selectedPlayer.team?this.kick():this.passTo(this.selectedPlayer)),t.keys[39]?this.selectedPlayer.movementX=1:t.keys[37]?this.selectedPlayer.movementX=-1:this.selectedPlayer.movementX=0,t.keys[40]?this.selectedPlayer.movementY=1:t.keys[38]?this.selectedPlayer.movementY=-1:this.selectedPlayer.movementY=0);var l=!0,r=!1,n=void 0;try{for(var h,o=function(){var t=h.value;if(t===i.selectedPlayer);else if("ending"===t.role){i.players.sort(function(t,e){return t.index-e.index});for(var l=0;l<i.players.length;l++)i.players[l].gotoTarget={x:l*(s/6)+32,y:a/2};i.players[0].setQuote("Pujdes"),i.players[1].setQuote("se"),i.players[2].setQuote("mnou"),i.players[3].setQuote("na"),i.players[4].setQuote("veceri"),i.players[5].setQuote("?")}else if("attacker"===t.role)t===i.ball.player?(t.goto({x:0===t.team?s:0,y:t.y+32*Math.random()-16}),Math.random()>.9995&&(t.direction=1===t.team,i.passTo(t))):null!=i.ball.player?i.ball.player.team===t.team||t.goto(i.ball.player):t.goto(i.ball);else if("defender"===t.role)if(t===i.ball.player)0===t.team&&t.x>s/2-32||1===t.team&&t.x<s/2+32?(console.log("kick"),t.direction=0===t.team,i.kick()):t.goto({x:s/2,y:a/2});else{if(t.goto({x:0===t.team?85:s-40-45,y:i.ball.y+1e3*i.ball.velocityY}),0===t.team&&i.ball.x<s/2||1===t.team&&i.ball.x>s/2)if(null==i.ball.player){var r=i.players.filter(function(e){return e.team===t.team});r.sort(function(t,e){return v(i.ball,t)-v(i.ball,e)}),r[0]===t&&t.goto(i.ball)}else i.ball.player.team!==t.team&&t.goto(i.ball.player)}t.update(e,s,a)},y=this.players[Symbol.iterator]();!(l=(h=y.next()).done);l=!0)o()}catch(O){r=!0,n=O}finally{try{l||null==y.return||y.return()}finally{if(r)throw n}}for(var c=0;c<this.players.length;c++)for(var u=c+1;u<this.players.length;u++)this.players[c].team!==this.players[u].team&&f(this.players[c],this.players[u],b.TACKLE_DISTANCE)&&this.tackle(this.players[c],this.players[u]);if(null==this.ball.player){var m=!0,p=!1,g=void 0;try{for(var x,w=this.players[Symbol.iterator]();!(m=(x=w.next()).done);m=!0){var k=x.value;if(k.x>this.ball.x-d.ballWidth&&k.x<this.ball.x+d.ballWidth&&k.y>this.ball.y-d.ballHeight&&k.y<this.ball.y+d.ballHeight&&this.ball.x>40&&this.ball.x<s-40&&this.ball.z<d.HOLDING_HEIGHT){this.ball.player=k;break}}}catch(O){p=!0,g=O}finally{try{m||null==w.return||w.return()}finally{if(p)throw g}}}if(!this.gameEnd&&(this.ball.x<40||this.ball.x>s-40)){if(null==this.ball.player)this.ball.lastPlayer.setQuote("Faul");else if(this.ball.x<40&&0===this.ball.player.team||this.ball.x>s-40&&1===this.ball.player.team)this.ball.player.setQuote("Faul");else{var S=!0,T=!1,P=void 0;try{for(var Y,M=this.players.filter(function(t){return t.team===i.ball.player.team})[Symbol.iterator]();!(S=(Y=M.next()).done);S=!0){var X=Y.value,A=["Hooray!","Yes!","Yeah!!"];X.setQuote(A[Math.random()*A.length|0])}}catch(O){T=!0,P=O}finally{try{S||null==M.return||M.return()}finally{if(T)throw P}}this.playSound("win.mp3"),this.score[this.ball.player.team]++,this.winnersThrow()}setTimeout(function(){return i.startLevel()},3e3),this.gameEnd=!0}this.ball.update(e,s,a),this.players.sort(function(t,e){return t.y-e.y}),t.lastKeys=t.keys.slice()}},{key:"tackle",value:function(t,e){var i={x:t.x-e.x,y:t.y-e.y};if((i=p(i)).x*=1*Math.random()*2,i.y*=1*Math.random()*2,t.velocityX=i.x,t.velocityY=i.y,e.velocityX=-1*i.x,e.velocityY=-1*i.y,(this.ball.player===t||this.ball.player===e)&&Math.random()>.1){var s=["Hey!","!!!","Ugh!"];Math.random()>.8&&this.ball.player.setQuote(s[Math.random()*s.length|0]),this.tackleDrop()}}},{key:"passTo",value:function(t){var e=this.players.filter(function(e){return t.team===e.team&&(0===t.team&&e.x<t.x||1===t.team&&e.x>t.x)}).sort(function(e){return 1===t.team?e.x-t.x:t.x-e.x})[0];null!=e&&this.ball.throw(e.x,e.y,1,.3)}},{key:"tackleDrop",value:function(){this.ball.throw(this.ball.x+1e-5*(2*Math.random()-1),this.ball.y+1e-5*(2*Math.random()-1),1,.2)}},{key:"kick",value:function(){this.ball.throw(this.ball.x+2*(0===this.ball.player.team?1:-1),this.ball.y+(2*Math.random()-1),2,.2)}},{key:"winnersThrow",value:function(){this.ball.throw(this.ball.x+1*(0===this.ball.player.team?1:-1),this.ball.y,-2,.2)}},{key:"draw",value:function(){var t=this.context;if(t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,this.canvas.clientWidth,this.canvas.clientHeight),"END"!==this.gameState){t.setTransform(1,0,0,1,0,0),t.save(),t.translate(0,100),t.drawImage(this.assets["field.png"],0,0);var e=!0,i=!1,s=void 0;try{for(var a,l=this.players[Symbol.iterator]();!(e=(a=l.next()).done);e=!0){var r=a.value;t.save(),t.translate(0|r.x,0|r.y),this.selectedPlayer===r&&(t.strokeStyle="#CC4444",t.beginPath(),t.ellipse(0,-1,12,4,0,0,2*Math.PI),t.stroke()),r.draw(t),t.restore()}}catch(h){i=!0,s=h}finally{try{e||null==l.return||l.return()}finally{if(i)throw s}}t.save(),t.translate(0|this.ball.x,0|this.ball.y);var n=(800-this.ball.z)/800;t.strokeStyle="black",t.fillStyle="black",t.beginPath(),t.ellipse(0,0,5*n,2*n,0,0,2*Math.PI),t.fill(),t.translate(0,-2),t.translate(0,-(0|this.ball.z)),t.rotate(this.ball.angle),t.translate(-this.assets["ball.png"].width/2,-this.assets["ball.png"].width/2),t.drawImage(this.assets["ball.png"],0,0),t.restore(),t.restore(),t.save(),t.strokeStyle="white",t.fillStyle="white",t.font="24px 'Press Start 2P'",t.fillText("LAWYERS vs DOCTORS",60,50),t.fillText(this.score[0],130,90),t.fillText(this.score[1],this.canvas.width-140,90),t.restore()}}},{key:"playSound",value:function(t){var e=this.assets[t];e.currentTime=0,e.play()}}]),t}(),x=function(t){function e(t){return Object(n.a)(this,e),Object(o.a)(this,Object(y.a)(e).call(this,t))}return Object(c.a)(e,t),Object(h.a)(e,[{key:"componentDidMount",value:function(){this.game=new g(this.canvas)}},{key:"render",value:function(){var t=this;return a.a.createElement("div",{className:"App"},a.a.createElement("canvas",{ref:function(e){return t.canvas=e},width:"512",height:"384",style:{imageRendering:"pixelated",padding:0,margin:"auto",display:"block",position:"absolute",border:"1px solid black",top:0,bottom:0,left:0,right:0}}))}}]),e}(s.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(a.a.createElement(x,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})},8:function(t,e,i){t.exports=i(16)}},[[8,2,1]]]);
//# sourceMappingURL=main.09390a3d.chunk.js.map